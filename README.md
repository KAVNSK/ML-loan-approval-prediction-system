# Система прогнозирования одобрения займа (ML)

## 1. Решаемая задача

Предсказание одобрения кредитной заявки (да/нет) по данным заявителя: пол, семейное положение, доход, сумма и срок займа, кредитная история, образование, занятость, тип недвижимости и др. Целевая переменная — **Loan_Status** (Y/N). Задача решается как бинарная классификация с полным циклом: разведка данных, препроцессинг, обучение нескольких моделей, выбор лучшей и консольный сервис для прогнозов.

## 2. Функционал проекта

- **Разведка данных (EDA):** анализ распределений, пропусков и выбросов; гистограммы, боксплоты, тепловая карта корреляций (сохранение в `output/`).
- **Препроцессинг:** заполнение пропусков, кодирование категориальных признаков, масштабирование; при дисбалансе классов — oversampling (RandomOverSampler).
- **Обучение:** пять моделей (LogisticRegression, RandomForest, GradientBoosting, XGBoost, LightGBM), кросс-валидация (k=5), метрики Accuracy, Precision, Recall, F1, ROC-AUC, матрицы ошибок; GridSearchCV для двух лучших моделей; сохранение лучшей модели, препроцессора и списка признаков в `models/`.
- **Визуализации:** сравнение моделей (столбчатая диаграмма метрик), ROC-кривые всех моделей на одном графике, важность признаков — в `output/`.
- **Консольный сервис (CUI):** интерактивный ввод одной заявки, одна строка через `--row`, пакетный прогноз по CSV; вывод прогноза (Y/N) и при возможности вероятности одобрения.

## 3. Установка и использование CUI

**Установка зависимостей:**

```bash
pip install -r requirements.txt
```

**Один раз обучить модель и сохранить артефакты:**

```bash
python pipeline.py
```

После этого доступен консольный сервис прогнозов.

**Интерактивный режим (по одному заявителю):**

```bash
python predict.py
```

**Одна строка (значения через запятую, порядок как в обучении):**

```bash
python predict.py --row "5000,0,120,360,1,Male,Yes,0,Graduate,No,Urban"
```

**Пакетный прогноз по CSV (те же колонки, что в обучающей выборке, без Loan_Status):**

```bash
python predict.py --csv archive/loan_sanction_test.csv
```

Результаты пакетного режима сохраняются в файл `{имя_файла}_predictions.csv` в той же папке.

## 4. Основные библиотеки, модели и технологии

- **Данные и вычисления:** pandas, numpy  
- **Модели:** scikit-learn (LogisticRegression, RandomForest, GradientBoosting), XGBoost, LightGBM  
- **Препроцессинг и пайплайны:** scikit-learn (StandardScaler, OneHotEncoder, SimpleImputer, ColumnTransformer, Pipeline), imbalanced-learn (RandomOverSampler, Pipeline)  
- **Валидация и метрики:** cross_validate, StratifiedKFold, GridSearchCV; accuracy, precision, recall, F1, ROC-AUC, confusion_matrix, roc_curve  
- **Визуализация:** matplotlib, seaborn  
- **Сохранение артефактов:** joblib  

## 5. Источник данных

Датасет - **Kaggle "Loan Prediction" / "Home Loan Approval"**: обучающая выборка — `archive/loan_sanction_train.csv`, при необходимости тестовая — `archive/loan_sanction_test.csv`

## 6. ИСтруктура проекта
`config.py` — пути и константы; 
`pipeline.py` — EDA, препроцессинг, обучение, графики; 
`predict.py` — консольный сервис; 
`archive/` — данные; 
`output/` — графики; 
`models/` — препроцессор, модель, список признаков (создаётся при запуске `pipeline.py`).
